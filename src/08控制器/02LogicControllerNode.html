<!--逻辑控制器-->
<div>
<div>
<h1>逻辑控制器</h1>

  <h3>功能特色</h3>
    <p>使用逻辑控制器来决定取样器的处理顺序</p>
  <h3>配置界面</h3>
</div>

<div class="alert alert-warning" role="alert">
<strong>注意!</strong> 鼠标悬停在界面中的任意标签或控件上，可以看到详细描述信息。
</div>

<div style="font-family:Microsoft YaHei">
<p><img class="img-responsive" alt="配置界面" src="image/LogicControllerNode.png"></p>
<h4>参数详解</h4>
<p>包括12种控制器</p>
<p><strong style="color:#708090">（1）ForeachControllerControl（ForEach控制器）：</strong>
  <p>ForEach控制器会循环遍历一系列相关变量，类似于编程语言中的for each语句。当测试人员为一个ForEach控制器添加取样器（或者控制器）后，每个取样器（或者控制器）都会被执行一次或者多次，每次循环变量都会有一个新值。输入应该包含多个变量，每一个变量都由下划线和数字扩展而来。每一个变量都必须有值。
  <p>例如，输入变量名为inputVar，则如下变量应该已经被定义了：
  <p>•	inputVar_1 = wendy</p>
  <p>•	inputVar_2 = charles</p>
  <p>•	inputVar_3 = peter</p>
  <p>•	inputVar_4 = john</p>
  </p>
  <strong>注意：</strong>分隔符"_"目前是可选的。
  当给定的返回值为“returnVar”时，ForEach控制器之下的取样器和控制器将会连续执行4次，上面的那些输入变量将会被用于取样器。
</p>
<p>

  ForEach控制器非常适合与前置处理器正则表达式一起使用。前置处理器正则表达式可以从前一个请求的结果数据中提取必要的输入变量。通过省略"_"分隔符，ForEach控制器使用输入变量refName_g可以循环遍历所有组合。另外，使用refName_${C}_g格式的输入变量还可以循环遍历所有匹配的所有组合，其中C是一个计数器变量。
</p>
<p>

  如果inputVar_1是空，ForEach控制器不会返回任何取样。当正则表达式没有返回任何匹配项时，就是这种情况。
</p>
</p>
  <p style="padding-left:30px"><strong>输入变量前缀:</strong>作为输入的变量名前缀</p>
  <p style="padding-left:30px"><strong>循环开始索引（排除）:</strong>开始索引（不包括），用于遍历变量（第一个元素是起始索引+1）</p>
  <p style="padding-left:30px"><strong>循环结束索引（包含）:</strong>结束索引（包括），用于遍历变量</p>
  <p style="padding-left:30px"><strong>输出变量名称:</strong>变量名，该变量可以在循环中替代取样的部分内容</p>
  <p style="padding-left:30px"><strong>使用分隔符</strong>如果不选中，"_"就会被省略</p>
<p ><strong style="color:#708090">（2）IfControllerControl（If控制器）：</strong>
  <p>控制其下的子测试元件是否执行。类似于编程语言中的If语句，根据给定表达式的值决定是否执行该节点下的子节点。
  </p>
</p>
  <p style="padding-left:30px"><strong>条件:</strong>默认情况下，判断条件以JavaScript代码的形式解释执行，返回“true”或者“false”。但这一方式可以被覆盖，见下面</p>
  <p style="padding-left:30px"><strong>条件作为表达式:</strong>如果勾选，那么判断条件必须是一个表达式，其求值为“true”（忽略大小写）。例如，${FOUND}或者${__jexl(${VAR} > 100)}。不同于JavaScript形式，判断条件只检查其值是否匹配“true”（忽略大小写）</p>
  <p style="padding-left:30px"><strong>控制所有下级:</strong>判断条件是否针对所有子测试元件，如果此项不勾选，则仅在初始入口处评估一次</p>

<p><strong style="color:#708090">（3）InterleaveController（交替控制器）</strong>
  <p>如果将取样器或者逻辑控制器放到交替控制器之下，那么每一次循环都会交替执行该控制器下的测试元件，也就是说在每次迭代时，顺序选取该节点下的一个子节点执行。</p>
</p>
  <p style="padding-left:30px"><strong>忽略子控制器:</strong>如果为true，则交替控制器会将其下的子控制器当成单一元素处理，并仅允许每个子控制器一次发出一个请求</p>
<p><strong style="color:#708090">（4）LoopControl（循环控制器）</strong>
  <p>如果将取样器或者逻辑控制器放到循环控制器之下，那么HyperPacer会将它们循环执行数次，循环次数在循环控制器中设定，也就是说简单地为其下的子节点运行指定次数。例如，假如测试人员将一个HTTP取样器放入循环控制器之下，循环变量值为2，并将并发测试的循环次数设置为3，HyperPacer总共会发送2*3=6 HTTP请求。</p>
</p>
  <p style="padding-left:30px"><strong>循环次数:</strong>一次测试执行过程中，循环控制器下属子测试元件被执行的次数。
    <p style = "padding-left:30px">
      <strong>注意：</strong>集成在并发测试中的循环控制器，它的表现会有所不同。除非值为-1，否则在达到设定循环次数后，它就会终止测试
    </p>
  </p>
<p><strong style="color:#708090">（5）OnceOnlyController（仅一次控制器）</strong>
  <p>
    仅一次控制器会告诉HyperPacer只执行其下的控制器一遍，接下来测试工程中的循环执行会跳过该控制器下的所有请求。是为了让测试工程中的某些内容在整个测试工程的执行期间对每个线程仅执行一次。
  </p>
  <p>
    仅一次控制器会在任何父循环控制器的第一次循环之中执行。因此，如果将仅一次控制器放在一个循环控制器（循环5次）之下，那么仅一次控制器只会在循环控制器的第一次循环时执行（举例，每5次）。请注意，将仅一次控制器放在测试场景之下，该控制器的表现也一样（每次测试只执行一遍），但是现在使用仅一次控制器有了更大的灵活性。
  </p>
  <p>
    对于要求登录的测试，可以考虑将登录请求放到仅一次控制器中，因为每一个并发线程都只需登录一次来建立会话。
  </p>
</p>

<p><strong style="color:#708090">（6）ParameterizedController（参数化控制器）</strong>
  <p>
    如果测试人员需要重复执行使用不同参数的相同的动作片段，那么就需要参数化控制器。参数化控制器可以向引入的测试工程片段传递参数。
  </p>
</p>

<p><strong style="color:#708090">（7）RandomController（随机控制器）</strong>
  <p>随机控制器的表现类似于交替控制器，唯一不同的就是其下的子测试元件不会按顺序轮流执行，而是每次循环随机挑选一个执行。</p>
</p>

<p><strong style="color:#708090">（8）RandomOrderController（随机顺序控制器）</strong>
  <p>随机顺序控制器很像一个简单控制器，其每一个子测试元件都至多执行一次，但是执行顺序却是随机的，也就是说每次执行时，按照随机产生的顺序执行其下的所有子节点。</p>
  <p><strong>注意：</strong>随机顺序控制器与随机控制器的不同之处在于，随机控制器只选择执行其所有子节点中的一个，而随机顺序控制器则按照随机顺序全部执行该控制器下的所有子节点。</p>
</p>

<p><strong style="color:#708090">（9）RunTime（时间控制器）</strong>
  <p>时间控制器可以控制其下子测试元件允许运行的时长。该控制器中指定的时间以秒为单位，仅对该控制器的子节点有效。</p>
    <p><strong style = "padding-left:30px">运行时间:</strong>要求的运行时长（以秒为单位）</p>
</p>

<p><strong style="color:#708090">（10）SwitchController（分支选择控制器）</strong>
  <p>分支选择控制器的表现类似于交替控制器，每一次循环都执行其下的子测试元件，不过并不是顺序执行，而是根据分支值选择执行。类似程序语言中的switch函数，该控制器根据给定的值n(可以使用参数)选择执行其下的第n+1个子节点。</p>
  <p>需要注意的是，分支选择控制器只接受整数值，并且给定的值n是以0为基础的，因此当给定的值“2”时，意味着该控制器下的第3个子节点会被执行。同时，分支选择控制器接受参数作为其值。</p>
  <p>如果分支值超过了范围，它就会运行零号测试元件（数字形式下的默认执行）。如果该值为空字符串，同样会运行零号测试元件。</p>
  <p>如果该值是非数字的（并且非空），那么分支选择控制器就会寻找名称相同的测试元件（区分大小写）。如果没有名称匹配，那么就选择名称为“default”的测试元件（不区分大小写）。如果没有名为“default”的测试元件，那么就不会选择任何测试元件，也不会运行任何测试元件。</p>
  <p><strong style = "padding-left:30px">分支值：</strong>选择执行的子测试元件对应数字（或名称）。子测试元件从0开始编号</p>
</p>

<p><strong style="color:#708090">（11）ThroughputController（吞吐量控制器）</strong>
  <p>吞吐量控制器允许用户设定其被执行的频率，用于控制其下的子节点的执行次数与负载比例分配。</p>
  <p>吞吐量控制器允许用户使用两种模式控制其下子节点的执行顺序：执行百分比和总执行次数。执行百分比模式允许负载在控制器下的子节点以某种比例进行分配，该控制器会执行固定比例的循环次数（以测试方案总的循环次数为基准）；总执行次数模式指定该控制器下所有子节点的准确迭代次数，该控制器会在执行数次（设定值）后停止执行。在比例模式下，设定的吞吐量值为一个0-100之间的整数，表示该控制器迭代次数占总迭代次数的百分比。同仅一次控制器一样，当父循环控制器开始新一轮循环时，控制器的设定值会被重置。</p>
  <p>如果要在一个测试方案中体现用户场景，吞吐量控制器应该是最合适的选择。</p>
  <p><strong style = "padding-left:30px">执行模式:</strong>决定该元件是否处于执行百分比模式或者总执行次数模式</p>
  <p><strong style = "padding-left:30px">每用户:</strong>如果选中该复选框，吞吐量控制器就会以虚拟用户为基础来计算它是否应该执行。如果没有选中该复选框，就是基于所有用户来计算的。例如。如果使用总执行次数模式，并且不选中“每用户”复选框，那么设定值就是吞吐量控制器的总执行次数，如果选中“每用户”复选框，那么总的执行次数就是虚拟用户乘以吞吐量设定值</p>
  <p><strong style = "padding-left:30px">吞吐量：</strong>一个数字。对于执行百分比模式，0~100表明该控件的执行比率。“50”就意味着该控件在整个测试计划中将执行50%的循环。对于总执行次数模式，该数字指明吞吐量控制器执行的总次数</p>
</p>

<p><strong style="color:#708090">（12）WhileController（While控制器）</strong>
  <p>一直运行自己的子测试元件，直到条件变为“false”。可能的条件值：</p>
  <p>•  Blank(空)：如果条件取值为空，则该条件迭代执行While控制器下的所有子节点，直到最后一个子节点返回失败为止。需要注意的是，如果不是最后一个子节点失败，而是While控制器中的其他子节点失败，While控制器不会停止，而会继续循环执行过程。</p>
  <p>•  LAST：如果条件取值为字符串LAST，则该While控制器迭代执行While控制器下的所有子节点，直到最后一个子节点返回失败为止（与条件为空时的行为相同）。同时，如果While控制器的上一个节点失败，则测试工程在执行时不会进入该While控制器。</p>
  <p>•  Otherwise（表达式）：除了为空和LAST外，条件还可以取一个表达式。当条件取值为表达式时，如果表达式的取值是字符串false，While控制器就退出循环。以下列出了几个可用的表达式：</p>
  <p>${VAR}：当参数VAR的值被设置成false时退出循环。</p>
  <p>${__javaScript(${C}==10)}：当参数C的值不为10时退出循环。</p>
  <p>${__javaScript("${VAR2}"=="abcd")}：当参数VAR2的值不为abcd时退出循环。</p>
  <p>${_P(property)} ：当属性property的取值为false时退出循环。</p>
  <p><strong style = "padding-left:30px">条件（函数或变量）:</strong>Blank、LAST或者variable/function</p>
</p>
</div>
</div>
